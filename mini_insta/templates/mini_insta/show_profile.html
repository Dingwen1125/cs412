<!--
    File: show_profile.html
    Author: Dingwen Yang (laoba@bu.edu), 2/12/2026
    Description: Show one MiniInsta profile with basic details.
-->
{% extends 'mini_insta/base.html' %}
{% block content %}
    <main class="profile-detail-container">
        <article class="profile-detail-card">
            {% if profile.profile_image_url %}
                <img class="profile-detail-image" src="{{profile.profile_image_url}}" alt="{{profile.display_name}}">
            {% endif %}

            <div class="profile-detail-content">
                <h2 class="profile-detail-name">{{profile.display_name}}</h2>
                <h3 class="profile-detail-username">@{{profile.username}}</h3>
                <p class="profile-detail-stats">
                    Followers:
                    <a href="{% url 'show_followers' profile.pk %}">{{ profile.get_num_followers }}</a>
                    |
                    Following:
                    <a href="{% url 'show_following' profile.pk %}">{{ profile.get_num_following }}</a>
                    |
                    Posts: {{ profile.get_all_posts|length }}
                </p>
                <p class="profile-detail-bio">{{profile.bio_text}}</p>
                <p class="profile-detail-join">Joined: {{profile.join_date}}</p>
                <p><a href="{% url 'update_profile' profile.pk %}">Update Profile</a></p>
            </div>
        </article>

        <section>
            <h2>Posts</h2>
            <p><a href="{% url 'create_post' profile.pk %}">Create New Post</a></p>
            {% for post in profile.get_all_posts %}
                <article class="profile-detail-card">
                    <div class="profile-detail-content">
                        <p><strong>Posted:</strong> {{post.timestamp}}</p>
                        {% if post.caption %}
                            <p class="profile-detail-bio">{{post.caption}}</p>
                        {% endif %}
                    </div>
                    <div class="profile-detail-content">
                        <a href="{% url 'show_post' post.pk %}">
                            {% with first_photo=post.get_all_photos.first %}
                            {% if first_photo %}
                                <img class="profile-detail-image" src="{{first_photo.get_image_url}}" alt="post photo">
                            {% else %}
                                <img class="profile-detail-image" src="{{default_photo_url}}" alt="default post photo">
                            {% endif %}
                            {% endwith %}
                        </a>
                    </div>
                </article>
            {% empty %}
                <p>No posts yet.</p>
            {% endfor %}
        </section>
    </main>
{% endblock %}
